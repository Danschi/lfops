- block:

  - name: 'Disable route to the ZEROCONF network that is added to the routing table by the network initscripts'
    ansible.builtin.lineinfile:
      path: '/etc/sysconfig/network'
      line: 'NOZEROCONF=yes'
      state: 'present'

  - name: 'Use fedora.linux_system_roles.network role to configure the network'
    include_role:
      name: 'fedora.linux_system_roles.network'

  - name: 'dnf remove hc-utils # hetzner cloud utilities - they cause problems with NetworkManager'
    ansible.builtin.package:
      name:
        - 'hc-utils'
      state: 'absent'

  - ansible.builtin.debug:
      msg: 'Please restart the network manually if needed (systemctl restart NetworkManager).'

  tags:
    - 'network'
