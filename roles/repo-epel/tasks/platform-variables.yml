# If names and settings differ across OS families, you can handle it with distribution or OS family
# specific vars files.
# https://redhat-cop.github.io/automation-good-practices/#supporting-multiple-distributions-and-versions

# The files in the loop are in order from least specific to most specific:
# * os_family covers a group of closely related platforms (e.g. RedHat covers RHEL, CentOS, Fedora)
# * distribution (e.g. Fedora) is more specific than os_family
# * distribution_distribution_major_version (e.g. RedHat_8) is more specific than distribution
# * distribution_distribution_version (e.g. RedHat_8.3) is the most specific

- name: 'Set platform/version specific variables'
  include_vars: '{{ __vars_file }}'
  loop:
    - '{{ ansible_facts["os_family"] }}.yml'                                                        # "RedHat.yml"
    - '{{ ansible_facts["os_family"] }}_{{ ansible_facts["distribution_major_version"] }}.yml'      # "RedHat_7.yml"
    - '{{ ansible_facts["os_family"] }}_{{ ansible_facts["distribution_version"] }}.yml'            # "RedHat_7.3.yml"
    - '{{ ansible_facts["distribution"] }}.yml'                                                     # "CentOS.yml"
    - '{{ ansible_facts["distribution"] }}_{{ ansible_facts["distribution_major_version"] }}.yml'   # "CentOS_7.yml"
    - '{{ ansible_facts["distribution"] }}_{{ ansible_facts["distribution_version"] }}.yml'         # "CentOS_7.3.yml"
  vars:
    __vars_file: '{{ role_path }}/vars/{{ item }}'
  when: __vars_file is file
