- block:

  - name: 'semanage fcontext --add --type var_log_t {{ apache_tomcat__install_dir }}/{{ item["key"] }}-{{ apache_tomcat__version }}/logs(/.*)?'
    community.general.sefcontext:
      setype: 'var_log_t'
      target: '{{ apache_tomcat__install_dir }}/{{ item["key"] }}-{{ apache_tomcat__version }}/logs(/.*)?'
      state: 'present'
    loop: '{{ apache_tomcat__instances | dict2items }}'

  - name: 'restorecon -RFv /opt/...'
    ansible.builtin.command: 'restorecon -RFv {{ apache_tomcat__install_dir }}/{{ item["key"] }}-{{ apache_tomcat__version }}' # restorecon does not follow symlinks
    loop: '{{ apache_tomcat__instances | dict2items }}'

  tags:
    - 'apache_tomcat'
