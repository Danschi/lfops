duplicity__backup_dest_container: '{{ ansible_nodename }}'
duplicity__backup_dest: 'swift://{{ duplicity__backup_dest_container | trim("/") }}'
duplicity__backup_retention_time: '30D' # days

duplicity__backup_sources__dependent_var: {}
duplicity__backup_sources__group_var: {}
duplicity__backup_sources__host_var: {}
duplicity__backup_sources__role_var:
  /backup:
    divide: false
  /etc:
    divide: false
  /home:
    divide: false
  /opt:
    divide: false
  /root:
    divide: false
  /var/spool/cron:
    divide: false
duplicity__backup_sources__combined_var: '{{ duplicity__backup_sources__role_var
    | combine(duplicity__backup_sources__dependent_var)
    | combine(duplicity__backup_sources__group_var)
    | combine(duplicity__backup_sources__host_var)
  }}'

duplicity__excludes:
  - '**/*.git*'
  - '**/*.svn*'
  - '**/*.temp'
  - '**/*.tmp'
  - '**/.cache'
  - '**/cache'
  - '**/log'

duplicity__timer_enabled: true
duplicity__on_calendar_hour: '23'
duplicity__on_calendar: '*-*-* {{ duplicity__on_calendar_hour }}:{{ 59 | random(seed=inventory_hostname) }}'

duplicity__loglevel: 'notice' # error, warning, notice, info, debug
duplicity__logrotate: 14

duplicity__swift_authurl: 'https://swiss-backup02.infomaniak.com/identity/v3'
duplicity__swift_authversion: '3'

duplicity__python_venv__venvs__dependent_var:
  - name: 'duplicity'
    packages:
      - 'duplicity'
      - 'python-swiftclient'
      - 'python-keystoneclient'
    package_requirements:
      - 'gcc'
      - 'librsync-devel'
    exposed_binaries:
      - 'duplicity'
