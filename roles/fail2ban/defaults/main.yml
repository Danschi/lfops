fail2ban__jail_default_action: |-
  %(banaction)s[name=%(__name__)s, bantime="%(bantime)s", port="%(port)s", protocol="%(protocol)s", chain="%(chain)s"]
  rocketchat[name=%(__name__)s, rocketchat-hook="%(rocketchat-hook)s"]
fail2ban__jail_default_banaction: 'iptables-multiport'
fail2ban__jail_default_ignoreip: []
fail2ban__jail_default_rocketchat_hook: ''
fail2ban__service_enabled: true


fail2ban__jail_portscan_allowed_ports:
  - 22
fail2ban__jail_portscan_server_ips: '{{ ansible_facts["all_ipv4_addresses"] }}'


fail2ban__role_jails:

  - name: 'portscan'
    state: 'present'
    type: 'conf'

  - name: 'sshd'
    state: 'present'
    type: 'conf'

fail2ban__dependent_jails: []
fail2ban__group_jails: []
fail2ban__host_jails: []

fail2ban__combined_jails: '{{ fail2ban__role_jails +
  fail2ban__group_jails +
  fail2ban__host_jails +
  fail2ban__dependent_jails
  | flatten
 }}'


# -----------------------------------------------------------------------------

fail2ban__python__dependent_modules:
  - 'python3-policycoreutils'
